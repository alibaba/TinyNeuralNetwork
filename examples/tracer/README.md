## Sample code for using tracer and code generator in TinyNeuralNetwork

[简体中文](README_zh-CN.md)

## Background

It is always hard to get the connections between nodes within a computation graph without calling `torch.jit.trace`. However, if we call the JIT ops, some of nodes in the graph may be removed, which makes it difficult to restore the graph in Python. By calling our tracer, you can get the connections between the nodes while the model is still runnable with Python. What's more, it can be used as a code generator that organizes the codes of your model into a single script.

## Sample usage
Please see `tracer_example.py`, which contains the basic usage.

## What's more
1. The model to be traced could either be instantiated inside or outside the with-block.
2. You may trace multiple models in one with-block.
3. It is supported to have runtime-defined constants. If the size is too large, these constants will be transformed to parameters.


## Limitations
1. Like `torch.jit.trace`, if you trace such models with control-flow ops, you may silently get incorrect results on subsequent invocations of the model.
2. Only the flow of PyTorch tensors is tracked. Other variables (e.g. numpy arrays, numbers and strings) won't be tracked and will be treated as constants.
3. Only those parts of the tensor property are tracked. For example, if you call `.data` or `.shape` of a tensor, the returned values will be joined in the computation graph. Below are the properties of a tensor that will be tracked.
  - `.data`
  - `.shape`
  - `.device`
  - `.dtype`
4. It is not supported to call numel on a torch.Size object generated by calling `.size()` or `.shape` on a tensor. Please use `torch.prod` instead.

## Frequently Asked Questions

Because of the high complexity and frequent updates of PyTorch, we cannot ensure that all cases are covered through automated testing. When you encounter problems
You can check out the [FAQ](../../docs/FAQ.md), or join the Q&A group in DingTalk via the QR Code below.

![img.png](../../docs/qa.png)
